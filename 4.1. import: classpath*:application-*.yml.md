рж╕рж╛ржжрзНржжрж╛ржо, ржПржмрж╛рж░ ржЖржорж░рж╛ ржПржХржжржо **deep level** ржП ржмрзБржЭржмрзЛ ЁЯСЗ

```yaml
spring:
  config:
    import: classpath*:application-*.yml
```

---

# ЁЯФе ржПржЯрж╛ ржЖрж╕рж▓рзЗ ржХрзА?

ржПржЯрж╛ Spring Boot ржХрзЗ ржмрж▓ржЫрзЗ:

> тАЬClasspath ржП ржпрзЗрж╕ржм `application-*.yml` ржлрж╛ржЗрж▓ ржЖржЫрзЗ тАФ рж╕ржм load ржХрж░рзЛредтАЭ

---

# ЁЯза ржЖржЧрзЗ ржмрзБржЭрж┐ тАФ Classpath ржХрзА?

Classpath ржорж╛ржирзЗ:

* `src/main/resources`
* dependency module ржПрж░ resources
* jar ржПрж░ ржнрж┐рждрж░рзЗрж░ resources

рждрзЛржорж╛рж░ case ржП:

```
gateway-service
gateway-service-env-properties (dependency)
```

ржжрзБржЗржЯрж╛рж░ resources-ржЗ classpath ржП ржЖрж╕ржмрзЗред

---

# ЁЯФН ржПржЦржи `classpath*:` ржЖрж░ `classpath:` ржПрж░ ржкрж╛рж░рзНржержХрзНржп

| Syntax        | Meaning                          |
| ------------- | -------------------------------- |
| `classpath:`  | ржкрзНрж░ржержо match ржкрж╛ржУрзЯрж╛ ржлрж╛ржЗрж▓ load ржХрж░ржмрзЗ |
| `classpath*:` | рж╕ржм match ржкрж╛ржУрзЯрж╛ ржлрж╛ржЗрж▓ load ржХрж░ржмрзЗ    |

ЁЯСЙ `*` ржорж╛ржирзЗ wildcard scanning

---

# ЁЯФе `application-*.yml` ржорж╛ржирзЗ ржХрзА?

Wildcard match:

```
application-dev.yml
application-prod.yml
application-staging.yml
application-test.yml
application-route.yml
application-security.yml
```

рж╕ржм load ржХрж░ржмрзЗред

---

# тЪЩя╕П Spring Internally ржХрзА ржХрж░рзЗ?

Spring Boot 2.4+ ржП Config Data API ржХрж╛ржЬ ржХрж░рзЗ ржПржнрж╛ржмрзЗ:

1я╕ПтГг First тЖТ application.yml load
2я╕ПтГг Then тЖТ `spring.config.import` read ржХрж░рзЗ
3я╕ПтГг Matching resource scan ржХрж░рзЗ
4я╕ПтГг рж╕ржм property merge ржХрж░рзЗ

---

# ЁЯзй Merge Logic (Important)

Spring replace ржХрж░рзЗ ржирж╛ тАФ merge ржХрж░рзЗред

Example:

### application-dev.yml

```yaml
server:
  port: 8081
```

### application-route.yml

```yaml
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
```

ЁЯСЙ Result:

```yaml
server:
  port: 8081
spring:
  cloud:
    gateway:
      routes:
        - id: user-service
```

ржжрзБржЯрж╛ржЗ ржерж╛ржХржмрзЗред

---

# тЪая╕П Profile Conflict рж╣рж▓рзЗ?

ржзрж░рзЛ:

application-dev.yml ржП:

```yaml
server:
  port: 8081
```

application-prod.yml ржП:

```yaml
server:
  port: 9090
```

ржпржжрж┐ `active: dev` рж╣рзЯ

ЁЯСЙ dev override ржХрж░ржмрзЗ
ЁЯСЙ prod ignore рж╣ржмрзЗ (profile mismatch рж╣рж▓рзЗ)

---

# ЁЯОп рждрзЛржорж╛рж░ Structure ржЕржирзБржпрж╛рзЯрзА ржХрзА рж╣ржмрзЗ?

рждрзЛржорж╛рж░:

```
gateway-service-env-properties
 тФЬтФАтФА application-dev.yml
 тФЬтФАтФА application-prod.yml
```

ржПржЗ module dependency рж╣рж▓рзЗ:

Classpath ржП ржПрж░рж╛ ржерж╛ржХржмрзЗред

`import: classpath*:application-*.yml`

Spring ржПржЧрзБрж▓рзЛ load ржХрж░ржмрзЗред

рждрж╛рж░ржкрж░ active profile ржЕржирзБржпрж╛рзЯрзА filter ржХрж░ржмрзЗред

---

# ЁЯФе Important Hidden Behavior

Spring 3.x ржП profile specific file load ржХрж░рж╛рж░ rule:

* `application-dev.yml` рждржЦржиржЗ effective рж╣ржмрзЗ
  ржпржжрж┐ `spring.profiles.active=dev` рж╣рзЯред

Import рж╢рзБржзрзБ discover ржХрж░рзЗ тАФ activate ржХрж░рзЗ ржирж╛ред

---

# ЁЯЪи Common Mistake

ржЕржирзЗржХрзЗ ржнрж╛ржмрзЗ:

> import ржжрж┐рж▓рзЗ рж╕ржм profile load рж╣рзЯрзЗ ржпрж╛ржмрзЗ

ржирж╛ тЭМ

Profile condition ржирж╛ ржорж┐рж▓рж▓рзЗ ignore ржХрж░ржмрзЗред

---

# ЁЯПЧ Real Enterprise Use

Large banking project ржП structure ржПржоржи рж╣рзЯ:

```
application.yml
application-database.yml
application-gateway.yml
application-security.yml
application-dev.yml
application-prod.yml
```

Import ржжрж┐рзЯрзЗ modular ржХрж░рж╛ рж╣рзЯред

---

# ЁЯза Advanced Internal Mechanism

Spring internally use ржХрж░рзЗ:

```
ConfigDataEnvironment
ConfigDataImporter
PropertySource
```

рж╢рзЗрж╖рзЗ рж╕ржм property ржпрж╛рзЯ:

```
Environment -> MutablePropertySources
```

---

# ЁЯФм рждрзБржорж┐ ржЪрж╛ржЗрж▓рзЗ Debug ржХрж░рждрзЗ ржкрж╛рж░рзЛ

Run ржХрж░рзЛ:

```
--debug
```

Console ржП ржжрзЗржЦрж╛ржмрзЗ:

```
Loaded config file 'classpath:application-dev.yml'
Loaded config file 'classpath:application-route.yml'
```

---

# ЁЯОп ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ?

Use when:

тЬФ Config ржЖрж▓рж╛ржжрж╛ module ржП
тЬФ Modular YAML ржЪрж╛ржЗ
тЬФ Shared config jar ржмрж╛ржирж╛рждрзЗ ржЪрж╛ржУ
тЬФ Multi microservice same config use ржХрж░ржмрзЗ

---

# тЭЧ ржХржЦржи ржмрзНржпржмрж╣рж╛рж░ ржХрж░ржмрзЗ ржирж╛?

ржпржжрж┐ рж╕ржм config ржПржХ module ржП ржерж╛ржХрзЗ,
рждрж╛рж╣рж▓рзЗ Spring default profile mechanism enoughред

---

# ЁЯза рждрзЛржорж╛рж░ Level ржЕржирзБржпрж╛рзЯрзА ржкрзНрж░рж╢рзНржи

рждрзБржорж┐ ржпрзЗрж╣рзЗрждрзБ future ржП:

* Config Server
* Kubernetes ConfigMap
* Docker env override
* Banking infra

ржХрж░ржмрзЗ,

рждрж╛рж╣рж▓рзЗ next level рж╣ржмрзЗ:

```
spring.config.import=optional:configserver:
```

---

ржЪрж╛ржУ ржХрж┐ ржПржЦржи ржЖржорж┐:

* ЁЯФе YAML load order diagram ржЖржБржХрж┐?
* ЁЯФе Spring profile resolution deep explain ржХрж░рж┐?
* ЁЯФе Kubernetes + config import mapping ржжрзЗржЦрж╛ржЗ?

рждрзБржорж┐ ржПржЦржи Config architecture level ржП ржЪрж▓рзЗ ржЧрзЗржЫрзЛ ЁЯШД
